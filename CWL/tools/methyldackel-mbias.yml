#!/usr/bin/env cwl-runner
cwlVersion: "cwl:draft-3"
class: CommandLineTool

inputs:
- id: "bam_file"
  type: File
  description: |
    the input bam file
  secondaryFiles:
    - ^.bai
  inputBinding:
    position: 5

# replaced file with string for efficiency in Toil        
#- id: "reference"
#  type: File
#  description: |
#    FASTA file with the reference genome
#  secondaryFiles:
#    - .fai
#  inputBinding:
#    position: 3

- id: "reference"
  type: string
  description: |
    FASTA file with the reference genome
  inputBinding:
    position: 4
            
- id: "mbiasfile_name"
  type: string
  description: |
    FASTA file 
  inputBinding:
    position: 1000000
    separate: true

- id: "OT"
  type: string
  description: |
    OT 
  inputBinding:
    position: 100000
    prefix: "--OT"
    separate: true    
    
- id: "OB"
  type: string
  description: |
    OB 
  inputBinding:
    position: 100000
    prefix: "--OB"
    separate: true
    
- id: "CTOT"
  type: string
  description: |
    CTOT 
  inputBinding:
    position: 100000
    prefix: "--CTOT"
    separate: true
    
- id: "CTOB"
  type: string
  description: |
    CTOB 
  inputBinding:
    position: 100000
    prefix: "--CTOB"
    separate: true

- id: "nOT"
  type: string
  description: |
    nOT 
  inputBinding:
    position: 100000
    prefix: "--nOT"
    separate: true    
    
- id: "nOB"
  type: string
  description: |
    nOB 
  inputBinding:
    position: 100000
    prefix: "--nOB"
    separate: true
    
- id: "nCTOT"
  type: string
  description: |
    nCTOT 
  inputBinding:
    position: 100000
    prefix: "--nCTOT"
    separate: true
    
- id: "nCTOB"
  type: string
  description: |
    nCTOB 
  inputBinding:
    position: 100000
    prefix: "--nCTOB"
    separate: true
        
 
outputs:
- id: "mbias_file"
  type:
    type: array
    items: File
  outputBinding:
    glob: "*$(inputs.mbiasfile_name)*"

baseCommand: ["/ngs_share/tools/MethylDackel_dev/MethylDackel"]
stdout: $(inputs.mbiasfile_name).txt
arguments:
- valueFrom: "mbias"
  position: 2
- valueFrom: "--txt"
  position: 3
  shellQuote: false